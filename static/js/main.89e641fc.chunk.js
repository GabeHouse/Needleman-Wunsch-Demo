(this["webpackJsonpalign-react"]=this["webpackJsonpalign-react"]||[]).push([[0],{12:function(e,t,a){e.exports=a(18)},17:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),r=a(10),s=a.n(r),c=(a(17),a(1)),i=a(6),m=a(3),h=a(5),o=a(4),u=a(2),p=a(11);var d=function(e){return n.a.createElement("div",{className:e.className,id:e.id,onClick:e.handleClick},n.a.createElement(p.a.div,null,e.value))};function g(e,t){!function(e){for(var t=0;t<e.length;t++)for(var a=0;a<e[0].length;a++)document.getElementById(e[t][a].id).style.backgroundColor="rgb(221, 255, 204)"}(t);for(var a=0;a<e.length;a++)document.getElementById(e[a]).style.backgroundColor="red"}function E(e){return Object(l.useEffect)((function(){g(e.D[e.D.length-1][e.D[0].length-1].path,e.D)}),[e]),n.a.createElement("div",null,n.a.createElement("table",null,n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement(d,{className:"letter_square"})),n.a.createElement("td",null,n.a.createElement(d,{className:"letter_square"})),e.seq2.split("").map((function(e,t){return n.a.createElement("td",{key:t},n.a.createElement(d,{value:e,className:"letter_square"}))}))),e.D.map((function(t,a){return n.a.createElement("tr",{key:a},n.a.createElement("td",null,n.a.createElement(d,{value:e.seq1.charAt(a-1),className:"letter_square"})),t.map((function(t,l){return n.a.createElement("td",{key:e.D[a][l].id},n.a.createElement("div",null,n.a.createElement(d,{value:e.D[a][l].score,className:"score_square",id:e.D[a][l].id,handleClick:function(){return g(e.D[a][l].path,e.D)}})))})))})))))}var b=function(e){Object(h.a)(a,e);var t=Object(o.a)(a);function a(e){var l;Object(c.a)(this,a);return(l=t.call(this,e)).state={seq1:"AATCTAG",seq2:"ATCGGTAG",matchScore:1,mismatchScore:-1,gapScore:-1},l.handleChange=l.handleChange.bind(Object(m.a)(l)),l}return Object(i.a)(a,[{key:"handleChange",value:function(e){"seq1"===e.target.id?this.setState({seq1:e.target.value.toString().toUpperCase()}):"seq2"===e.target.id?this.setState({seq2:e.target.value.toString().toUpperCase()}):"match"===e.target.id?this.setState({matchScore:e.target.value}):"mismatch"===e.target.id?this.setState({mismatchScore:e.target.value}):"gap"!==e.target.id||isNaN(e.target.value)||this.setState({gapScore:e.target.value})}},{key:"render",value:function(){var e=this,t=isNaN(parseInt(this.state.matchScore))?0:parseInt(this.state.matchScore),a=isNaN(parseInt(this.state.mismatchScore))?0:parseInt(this.state.mismatchScore),l=isNaN(parseInt(this.state.gapScore))?0:parseInt(this.state.gapScore),r=function(e,t,a,l,n){for(var r=new Array(e.length+1),s=0;s<e.length+1;s++)r[s]=new Array(t.length+1),r[s][0]={score:n*s,a:e.substring(0,s),b:"-".repeat(s)},r[s][0].id=s+",0",r[s][0].path=s>0?Object(u.a)(r[s-1][0].path):[],r[s][0].path.push(r[s][0].id.valueOf());for(var c=0;c<t.length+1;c++)r[0][c]={score:n*c,a:"-".repeat(c),b:t.substring(0,c)},r[0][c].id="0,"+c.toString(),r[0][c].path=c>0?Object(u.a)(r[0][c-1].path):[],r[0][c].path.push(r[0][c].id.valueOf());for(var i=0;i<e.length;i++)for(var m=0;m<t.length;m++){var h=t.charAt(m)===e.charAt(i)?a:l,o=Math.max(r[i][m].score+h,r[i][m+1].score+n,r[i+1][m].score+n);r[i+1][m+1]={},r[i+1][m+1].score=o,r[i+1][m+1].id=i+1+","+(m+1),o===r[i][m].score+h?(r[i+1][m+1].a=r[i][m].a+e.charAt(i),r[i+1][m+1].b=r[i][m].b+t.charAt(m),r[i+1][m+1].path=Object(u.a)(r[i][m].path)):o===r[i][m+1].score+n?(r[i+1][m+1].a=r[i][m+1].a+e.charAt(i),r[i+1][m+1].b=r[i][m+1].b+"-",r[i+1][m+1].path=Object(u.a)(r[i][m+1].path)):(r[i+1][m+1].a=r[i+1][m].a+"-",r[i+1][m+1].b=r[i+1][m].b+t.charAt(m),r[i+1][m+1].path=Object(u.a)(r[i+1][m].path)),r[i+1][m+1].path.push(r[i+1][m+1].id.valueOf())}return r}(this.state.seq1,this.state.seq2,t,a,l);return n.a.createElement("div",{id:"main"},n.a.createElement("p",null,"I was introduced to the ",n.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Needleman%E2%80%93Wunsch_algorithm"},"Needleman-Wunsch algorithm ")," during a fourth year CS course in the context of comparing two species' genomes (multi-billion character DNA strings) to see if they share a common ancestor. What is so fascinating about the algorithm is its simplicity, yet its ability to reduce to other popular dynamic programming problems such as ",n.a.createElement("button",{onClick:function(){e.setState({matchScore:1,mismatchScore:0,gapScore:0})}},"Longest Common Subsequence"),"  and ",n.a.createElement("button",{onClick:function(){e.setState({matchScore:0,mismatchScore:-1,gapScore:-1})}},"Edit Distance")," by changing the score scheme. The Needleman-Wunsch algorithm is still widely used in areas like bioinformatics, where its quadratic time and linear space complexities make it useful for aligning long strings."),n.a.createElement("p",null,"The problem is solved by filling table DP using the recurrence relation,",n.a.createElement("br",null),"$$\\small","\\texttt{ DP[i, j] = max}","\\begin","{cases}","\\small","\\texttt{DP[i-1, j-1] + score(S[i], T[j])}","\\\\ \\small","\\texttt{DP[i-1, j] + score(S[i], -)}","\\\\ \\small","\\texttt{DP[i, j-1] + score(-, T[j])}","\\end","{cases}","\\texttt","{= max}","\\begin","{cases}","\\small","\\texttt{DP[i-1, j-1] + (match_score}\\texttt{ if }\\texttt{ S[i] == T[j] }\\texttt{ else  }\\texttt{ mismatch_score)}","\\\\ \\small","\\texttt{DP[i-1, j] + gap_score}","\\\\ \\small","\\texttt{DP[i, j-1] + gap_score}","\\end","{cases}","$$ to compute the optimal score, then backtracking (shown below in red) to find the corresponding alignment."),n.a.createElement("table",{id:"param_result"},n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("label",{className:"param_label"}," Sequence S")),n.a.createElement("td",{colSpan:"4"},n.a.createElement("input",{type:"text",id:"seq1",className:"seq",value:this.state.seq1,maxLength:"20",onChange:this.handleChange}))),n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("label",{className:"param_label"},"Sequence T")),n.a.createElement("td",{colSpan:"4"},n.a.createElement("input",{type:"text",id:"seq2",className:"seq",value:this.state.seq2,maxLength:"20",onChange:this.handleChange}))),n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("table",null,n.a.createElement("tr",null,n.a.createElement("label",{className:"param_label"},"Match Score")),n.a.createElement("tr",null,n.a.createElement("input",{className:"params",id:"match",type:"number",value:this.state.matchScore,onChange:this.handleChange})))),n.a.createElement("td",null,n.a.createElement("table",null,n.a.createElement("tr",null,n.a.createElement("label",{className:"param_label"},"Mismatch Score")),n.a.createElement("tr",null,n.a.createElement("input",{className:"params",id:"mismatch",type:"number",value:this.state.mismatchScore,onChange:this.handleChange})))),n.a.createElement("td",null,n.a.createElement("table",null,n.a.createElement("tr",null,n.a.createElement("label",{className:"param_label"},"Gap Score")),n.a.createElement("tr",null,n.a.createElement("input",{className:"params",id:"gap",type:"number",value:this.state.gapScore,onChange:this.handleChange})))))),n.a.createElement("td",{rowSpan:"10",id:"result"},n.a.createElement("table",{id:"alignment"},n.a.createElement("tr",null,n.a.createElement("table",null,n.a.createElement("tbody",null,n.a.createElement("tr",null,r[this.state.seq1.length][this.state.seq2.length].a.split("").map((function(e,t){return n.a.createElement("td",null,e)}))),n.a.createElement("tr",null,r[this.state.seq1.length][this.state.seq2.length].b.split("").map((function(e,t){return n.a.createElement("td",null,e)})))))),n.a.createElement("tr",null,"Score: "+r[this.state.seq1.length][this.state.seq2.length].score))))),n.a.createElement("div",null,n.a.createElement(E,{D:r,seq1:this.state.seq1,seq2:this.state.seq2})))}}]),a}(n.a.Component);s.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(b,null)),document.getElementById("root"))}},[[12,1,2]]]);
//# sourceMappingURL=main.89e641fc.chunk.js.map